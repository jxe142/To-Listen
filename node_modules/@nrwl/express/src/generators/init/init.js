"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.initSchematic = exports.initGenerator = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nrwl/devkit");
const node_1 = require("@nrwl/node");
const versions_1 = require("@nrwl/node/src/utils/versions");
const versions_2 = require("../../utils/versions");
function updateDependencies(tree) {
    (0, devkit_1.removeDependenciesFromPackageJson)(tree, ['@nrwl/express'], []);
    return (0, devkit_1.addDependenciesToPackageJson)(tree, {
        express: versions_2.expressVersion,
        tslib: versions_1.tslibVersion,
    }, {
        '@types/express': versions_2.expressTypingsVersion,
        '@nrwl/express': versions_2.nxVersion,
    });
}
function initGenerator(tree, schema) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const initTask = yield (0, node_1.initGenerator)(tree, schema);
        const installTask = updateDependencies(tree);
        if (!schema.skipFormat) {
            yield (0, devkit_1.formatFiles)(tree);
        }
        return () => tslib_1.__awaiter(this, void 0, void 0, function* () {
            yield initTask();
            yield installTask();
        });
    });
}
exports.initGenerator = initGenerator;
exports.default = initGenerator;
exports.initSchematic = (0, devkit_1.convertNxGenerator)(initGenerator);
//# sourceMappingURL=init.js.map